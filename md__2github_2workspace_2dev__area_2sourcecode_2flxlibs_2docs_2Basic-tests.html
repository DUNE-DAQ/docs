<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DUNE-DAQ: Basic tests</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DUNE-DAQ
   </div>
   <div id="projectbrief">DUNE Trigger and Data Acquisition software</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Basic tests</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md57"></a>You can do this either using the felix UPS product in the dune-daq software or a custom build of the felix software suite provided by ATLAS TDAQ.</p>
<p>To use the UPS product, you can use these tools where you did run: </p><div class="fragment"><div class="line">dbt-workarea-env</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md58"></a>
Low level FELIX tools</h2>
<p><code>fdaq</code> is a tool that reads data from the FELIX card, and is provided by FELIX software suite. For running 5 seconds the emulator on SLR0, do the following:</p>
<div class="fragment"><div class="line">fdaq -e -d 0 -t 10</div>
</div><!-- fragment --><p> For checking the second half of the card, you can read SLR1 with:</p>
<div class="fragment"><div class="line">fdaq -e -d 1 -t 10</div>
</div><!-- fragment --><p>The output should be similar to this: </p><div class="fragment"><div class="line">[np04daq@np04-srv-030 dunedaq]$ fdaq -e -d 0 -t 5</div>
<div class="line">Consume FLX-device data while checking the data (blockheader and trailers),</div>
<div class="line">counts errors including chunk truncation, halts when the memory buffer is near overflowing.</div>
<div class="line">Also counts chunk CRC errors.</div>
<div class="line">Opened FLX-device 0, firmw FLX712-FM-6chan-2106091300-GIT:rm-5.0/1577, trailer=32bit block=4K, buffer=1024MB</div>
<div class="line">**START(emulator)** using DMA #0 polling</div>
<div class="line">  Secs | Recvd[MB/s] | File[MB/s] | Total[(M)B] | Rec[(M)B] | Buf[%] | Wraps</div>
<div class="line">-------|-------------|------------|-------------|-----------|--------|-------</div>
<div class="line">     1        4642.9          0.0        4642.9           0       10       4</div>
<div class="line">     2        4657.8          0.0        9300.7           0        8       8</div>
<div class="line">     3        4657.9          0.0       13958.6           0        3      12</div>
<div class="line">     4        4652.8          0.0       18611.3           0        2      17</div>
<div class="line">     5        4654.0          0.0       23265.3           0        1      21</div>
<div class="line">**STOP**</div>
<div class="line">-&gt; Data checked: Blocks 5680005, Errors: header=0 trailer=0</div>
<div class="line">Exiting..</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md59"></a>
flxlibs applications</h2>
<p>From this point, the FELIX dataflow can be started, and <code>flxlibs</code> modules can read the memory blocks that contain data produced by the FELIX card. In order to be sure that the configuration step was successful, one can try to run the <code>CardWrapper</code> test app:</p>
<div class="fragment"><div class="line">flxlibs_test_cardwrapper</div>
</div><!-- fragment --><p> The expected output is something similar to the following:</p>
<div class="fragment"><div class="line">(dbt-pyvenv) [epdtdi@epdtdi104 minidaqapp]$ flxlibs_test_cardwrapper </div>
<div class="line">2021-Mar-03 20:47:38,399 LOG [main(...) at test_cardwrapper_app.cxx:42] Creating CardWrapper...</div>
<div class="line">2021-Mar-03 20:47:38,399 LOG [main(...) at test_cardwrapper_app.cxx:34] Application will terminate in 5s and show encountered ELink IDs in BLOCK headers...</div>
<div class="line">2021-Mar-03 20:47:38,406 LOG [main(...) at test_cardwrapper_app.cxx:62] Init CardWrapper...</div>
<div class="line">2021-Mar-03 20:47:38,406 LOG [main(...) at test_cardwrapper_app.cxx:65] Configure CardWrapper...</div>
<div class="line">2021-Mar-03 20:47:38,406 LOG [CardWrapper::configure(...) at CardWrapper.cpp:83] Configuring CardWrapper of card [id:0 slr:0]</div>
<div class="line">2021-Mar-03 20:47:38,413 LOG [main(...) at test_cardwrapper_app.cxx:68] Start CardWrapper...</div>
<div class="line">2021-Mar-03 20:47:38,413 LOG [main(...) at test_cardwrapper_app.cxx:71] Flipping killswitch in order to stop...</div>
<div class="line">2021-Mar-03 20:47:43,407 LOG [main(...) at test_cardwrapper_app.cxx:76] Stop CardWrapper...</div>
<div class="line">2021-Mar-03 20:47:43,427 LOG [main(...) at test_cardwrapper_app.cxx:79] Number of blocks DMA-d: 5767168-&gt; Per elink: </div>
<div class="line">2021-Mar-03 20:47:43,427 LOG [main(...) at test_cardwrapper_app.cxx:82]   elink(0): 1153433</div>
<div class="line">2021-Mar-03 20:47:43,427 LOG [main(...) at test_cardwrapper_app.cxx:82]   elink(64): 1153434</div>
<div class="line">2021-Mar-03 20:47:43,427 LOG [main(...) at test_cardwrapper_app.cxx:82]   elink(128): 1153434</div>
<div class="line">2021-Mar-03 20:47:43,427 LOG [main(...) at test_cardwrapper_app.cxx:82]   elink(192): 1153434</div>
<div class="line">2021-Mar-03 20:47:43,427 LOG [main(...) at test_cardwrapper_app.cxx:82]   elink(256): 1153433</div>
<div class="line">2021-Mar-03 20:47:43,427 LOG [main(...) at test_cardwrapper_app.cxx:85] Exiting.</div>
</div><!-- fragment --><p>The critical part that indicates success is the following: </p><div class="fragment"><div class="line">2021-Mar-03 20:47:43,427 LOG [main(...) at test_cardwrapper_app.cxx:79] Number of blocks DMA-d: 5767168-&gt; Per elink: </div>
<div class="line">2021-Mar-03 20:47:43,427 LOG [main(...) at test_cardwrapper_app.cxx:82]   elink(0): 1153433</div>
<div class="line">2021-Mar-03 20:47:43,427 LOG [main(...) at test_cardwrapper_app.cxx:82]   elink(64): 1153434</div>
<div class="line">2021-Mar-03 20:47:43,427 LOG [main(...) at test_cardwrapper_app.cxx:82]   elink(128): 1153434</div>
<div class="line">2021-Mar-03 20:47:43,427 LOG [main(...) at test_cardwrapper_app.cxx:82]   elink(192): 1153434</div>
<div class="line">2021-Mar-03 20:47:43,427 LOG [main(...) at test_cardwrapper_app.cxx:82]   elink(256): 1153433</div>
</div><!-- fragment --><p>If you observe different values, the EMU data might not be configured properly. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 24 2024 for DUNE-DAQ by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
