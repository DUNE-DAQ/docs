<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DUNE-DAQ: triggeralgs::TAWindow Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DUNE-DAQ
   </div>
   <div id="projectbrief">DUNE Trigger and Data Acquisition software</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacetriggeralgs.html">triggeralgs</a></li><li class="navelem"><a class="el" href="classtriggeralgs_1_1TAWindow.html">TAWindow</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#friends">Friends</a> &#124;
<a href="classtriggeralgs_1_1TAWindow-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">triggeralgs::TAWindow Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="TAWindow_8hpp_source.html">TAWindow.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ab5a6c90acf2277d7651be4c47a047731" id="r_ab5a6c90acf2277d7651be4c47a047731"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriggeralgs_1_1TAWindow.html#ab5a6c90acf2277d7651be4c47a047731">is_empty</a> () const</td></tr>
<tr class="separator:ab5a6c90acf2277d7651be4c47a047731"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59e8460960590df1de1c492665473a15" id="r_a59e8460960590df1de1c492665473a15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriggeralgs_1_1TAWindow.html#a59e8460960590df1de1c492665473a15">add</a> (const <a class="el" href="structtriggeralgs_1_1TriggerActivity.html">TriggerActivity</a> &amp;input_ta)</td></tr>
<tr class="memdesc:a59e8460960590df1de1c492665473a15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add the input TA's contribution to the total ADC, increase the hit count of all of the channels which feature and add it to the TA list keeping the TA list time ordered by time_start. Preserving time order makes moving easier.  <br /></td></tr>
<tr class="separator:a59e8460960590df1de1c492665473a15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e6121462144967a27ad032428ea91c9" id="r_a3e6121462144967a27ad032428ea91c9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriggeralgs_1_1TAWindow.html#a3e6121462144967a27ad032428ea91c9">clear</a> ()</td></tr>
<tr class="memdesc:a3e6121462144967a27ad032428ea91c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear all inputs.  <br /></td></tr>
<tr class="separator:a3e6121462144967a27ad032428ea91c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad92d556ccf9b7f241da1ed070e808d83" id="r_ad92d556ccf9b7f241da1ed070e808d83"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriggeralgs_1_1TAWindow.html#ad92d556ccf9b7f241da1ed070e808d83">n_channels_hit</a> ()</td></tr>
<tr class="separator:ad92d556ccf9b7f241da1ed070e808d83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af03b5a4fc3fc2c1d7b99d5cd493eda60" id="r_af03b5a4fc3fc2c1d7b99d5cd493eda60"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriggeralgs_1_1TAWindow.html#af03b5a4fc3fc2c1d7b99d5cd493eda60">move</a> (<a class="el" href="structtriggeralgs_1_1TriggerActivity.html">TriggerActivity</a> const &amp;input_ta, <a class="el" href="namespacetriggeralgs.html#a71eb817804d67a3159db1cebe6a2c2a3">timestamp_t</a> const &amp;window_length)</td></tr>
<tr class="memdesc:af03b5a4fc3fc2c1d7b99d5cd493eda60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find all of the TAs in the window that need to be removed if the input_ta is to be added and the size of the window is to be conserved. Subtract those TAs' contribution from the total window ADC and remove their contributions to the hit counts.  <br /></td></tr>
<tr class="separator:af03b5a4fc3fc2c1d7b99d5cd493eda60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd4fc83af5fefd45314f11b3455e4901" id="r_acd4fc83af5fefd45314f11b3455e4901"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriggeralgs_1_1TAWindow.html#acd4fc83af5fefd45314f11b3455e4901">reset</a> (<a class="el" href="structtriggeralgs_1_1TriggerActivity.html">TriggerActivity</a> const &amp;input_ta)</td></tr>
<tr class="memdesc:acd4fc83af5fefd45314f11b3455e4901"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset window content on the input.  <br /></td></tr>
<tr class="separator:acd4fc83af5fefd45314f11b3455e4901"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a25d53d4e6fc07eadcc932f8787e4fd4f" id="r_a25d53d4e6fc07eadcc932f8787e4fd4f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacetriggeralgs.html#a71eb817804d67a3159db1cebe6a2c2a3">timestamp_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriggeralgs_1_1TAWindow.html#a25d53d4e6fc07eadcc932f8787e4fd4f">time_start</a></td></tr>
<tr class="separator:a25d53d4e6fc07eadcc932f8787e4fd4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a070dc99f134cf339d975d41d1dae0b2a" id="r_a070dc99f134cf339d975d41d1dae0b2a"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriggeralgs_1_1TAWindow.html#a070dc99f134cf339d975d41d1dae0b2a">adc_integral</a></td></tr>
<tr class="separator:a070dc99f134cf339d975d41d1dae0b2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa483baf5d65b068cb68f8b1e037d5862" id="r_aa483baf5d65b068cb68f8b1e037d5862"><td class="memItemLeft" align="right" valign="top">std::unordered_map&lt; <a class="el" href="namespacetriggeralgs.html#a3b366738e21766946bfe8f1a4593d06b">channel_t</a>, uint16_t &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriggeralgs_1_1TAWindow.html#aa483baf5d65b068cb68f8b1e037d5862">channel_states</a></td></tr>
<tr class="separator:aa483baf5d65b068cb68f8b1e037d5862"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6690ef66c223a08fc64b16e873c86dda" id="r_a6690ef66c223a08fc64b16e873c86dda"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structtriggeralgs_1_1TriggerActivity.html">TriggerActivity</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a></td></tr>
<tr class="separator:a6690ef66c223a08fc64b16e873c86dda"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="friends" name="friends"></a>
Friends</h2></td></tr>
<tr class="memitem:adc5fed6d6b9a63c3be6c5faa6866f6c1" id="r_adc5fed6d6b9a63c3be6c5faa6866f6c1"><td class="memItemLeft" align="right" valign="top">std::ostream &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classtriggeralgs_1_1TAWindow.html#adc5fed6d6b9a63c3be6c5faa6866f6c1">operator&lt;&lt;</a> (std::ostream &amp;os, const <a class="el" href="classtriggeralgs_1_1TAWindow.html">TAWindow</a> &amp;window)</td></tr>
<tr class="separator:adc5fed6d6b9a63c3be6c5faa6866f6c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="TAWindow_8hpp_source.html#l00019">19</a> of file <a class="el" href="TAWindow_8hpp_source.html">TAWindow.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a59e8460960590df1de1c492665473a15" name="a59e8460960590df1de1c492665473a15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59e8460960590df1de1c492665473a15">&#9670;&#160;</a></span>add()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void triggeralgs::TAWindow::add </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structtriggeralgs_1_1TriggerActivity.html">TriggerActivity</a> &amp;&#160;</td>
          <td class="paramname"><em>input_ta</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add the input TA's contribution to the total ADC, increase the hit count of all of the channels which feature and add it to the TA list keeping the TA list time ordered by time_start. Preserving time order makes moving easier. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input_ta</td><td></td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="TAWindow_8cpp_source.html#l00016">16</a> of file <a class="el" href="TAWindow_8cpp_source.html">TAWindow.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   17</span>{</div>
<div class="line"><span class="lineno">   18</span> </div>
<div class="line"><span class="lineno">   19</span>  <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a070dc99f134cf339d975d41d1dae0b2a">adc_integral</a> += input_ta.adc_integral;</div>
<div class="line"><span class="lineno">   20</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespacetriggeralgs.html#a7a9ef2563dfb84a0839fb5ab230b1728">TriggerPrimitive</a> tp : input_ta.<a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a>) {</div>
<div class="line"><span class="lineno">   21</span>    <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#aa483baf5d65b068cb68f8b1e037d5862">channel_states</a>[tp.channel]++;</div>
<div class="line"><span class="lineno">   22</span>  }</div>
<div class="line"><span class="lineno">   23</span>  <span class="comment">// Perform binary search based on time_start.</span></div>
<div class="line"><span class="lineno">   24</span>  uint16_t insert_at = 0;</div>
<div class="line"><span class="lineno">   25</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> ta : <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a>) {</div>
<div class="line"><span class="lineno">   26</span>    <span class="keywordflow">if</span> (input_ta.time_start &lt; ta.time_start)</div>
<div class="line"><span class="lineno">   27</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   28</span>    insert_at++;</div>
<div class="line"><span class="lineno">   29</span>  }</div>
<div class="line"><span class="lineno">   30</span>  <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a>.insert(<a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a>.begin() + insert_at, input_ta);</div>
<div class="line"><span class="lineno">   31</span>}</div>
<div class="ttc" id="aclasstriggeralgs_1_1TAWindow_html_a070dc99f134cf339d975d41d1dae0b2a"><div class="ttname"><a href="classtriggeralgs_1_1TAWindow.html#a070dc99f134cf339d975d41d1dae0b2a">triggeralgs::TAWindow::adc_integral</a></div><div class="ttdeci">uint64_t adc_integral</div><div class="ttdef"><b>Definition</b> <a href="TAWindow_8hpp_source.html#l00053">TAWindow.hpp:53</a></div></div>
<div class="ttc" id="aclasstriggeralgs_1_1TAWindow_html_a6690ef66c223a08fc64b16e873c86dda"><div class="ttname"><a href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">triggeralgs::TAWindow::inputs</a></div><div class="ttdeci">std::vector&lt; TriggerActivity &gt; inputs</div><div class="ttdef"><b>Definition</b> <a href="TAWindow_8hpp_source.html#l00055">TAWindow.hpp:55</a></div></div>
<div class="ttc" id="aclasstriggeralgs_1_1TAWindow_html_aa483baf5d65b068cb68f8b1e037d5862"><div class="ttname"><a href="classtriggeralgs_1_1TAWindow.html#aa483baf5d65b068cb68f8b1e037d5862">triggeralgs::TAWindow::channel_states</a></div><div class="ttdeci">std::unordered_map&lt; channel_t, uint16_t &gt; channel_states</div><div class="ttdef"><b>Definition</b> <a href="TAWindow_8hpp_source.html#l00054">TAWindow.hpp:54</a></div></div>
<div class="ttc" id="anamespacetriggeralgs_html_a7a9ef2563dfb84a0839fb5ab230b1728"><div class="ttname"><a href="namespacetriggeralgs.html#a7a9ef2563dfb84a0839fb5ab230b1728">triggeralgs::TriggerPrimitive</a></div><div class="ttdeci">dunedaq::trgdataformats::TriggerPrimitive TriggerPrimitive</div><div class="ttdef"><b>Definition</b> <a href="triggeralgs_2include_2triggeralgs_2TriggerPrimitive_8hpp_source.html#l00022">TriggerPrimitive.hpp:22</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3e6121462144967a27ad032428ea91c9" name="a3e6121462144967a27ad032428ea91c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e6121462144967a27ad032428ea91c9">&#9670;&#160;</a></span>clear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void triggeralgs::TAWindow::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear all inputs. </p>

<p class="definition">Definition at line <a class="el" href="TAWindow_8cpp_source.html#l00035">35</a> of file <a class="el" href="TAWindow_8cpp_source.html">TAWindow.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   36</span>{</div>
<div class="line"><span class="lineno">   37</span>  <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a>.clear();</div>
<div class="line"><span class="lineno">   38</span>  <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#aa483baf5d65b068cb68f8b1e037d5862">channel_states</a>.clear();</div>
<div class="line"><span class="lineno">   39</span>  <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a25d53d4e6fc07eadcc932f8787e4fd4f">time_start</a> = 0;</div>
<div class="line"><span class="lineno">   40</span>  <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a070dc99f134cf339d975d41d1dae0b2a">adc_integral</a> = 0;</div>
<div class="line"><span class="lineno">   41</span>};</div>
<div class="ttc" id="aclasstriggeralgs_1_1TAWindow_html_a25d53d4e6fc07eadcc932f8787e4fd4f"><div class="ttname"><a href="classtriggeralgs_1_1TAWindow.html#a25d53d4e6fc07eadcc932f8787e4fd4f">triggeralgs::TAWindow::time_start</a></div><div class="ttdeci">timestamp_t time_start</div><div class="ttdef"><b>Definition</b> <a href="TAWindow_8hpp_source.html#l00052">TAWindow.hpp:52</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab5a6c90acf2277d7651be4c47a047731" name="ab5a6c90acf2277d7651be4c47a047731"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5a6c90acf2277d7651be4c47a047731">&#9670;&#160;</a></span>is_empty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool triggeralgs::TAWindow::is_empty </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="TAWindow_8hpp_source.html#l00022">22</a> of file <a class="el" href="TAWindow_8hpp_source.html">TAWindow.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   22</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a>.empty(); };</div>
</div><!-- fragment -->
</div>
</div>
<a id="af03b5a4fc3fc2c1d7b99d5cd493eda60" name="af03b5a4fc3fc2c1d7b99d5cd493eda60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af03b5a4fc3fc2c1d7b99d5cd493eda60">&#9670;&#160;</a></span>move()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void triggeralgs::TAWindow::move </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtriggeralgs_1_1TriggerActivity.html">TriggerActivity</a> const &amp;&#160;</td>
          <td class="paramname"><em>input_ta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacetriggeralgs.html#a71eb817804d67a3159db1cebe6a2c2a3">timestamp_t</a> const &amp;&#160;</td>
          <td class="paramname"><em>window_length</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find all of the TAs in the window that need to be removed if the input_ta is to be added and the size of the window is to be conserved. Subtract those TAs' contribution from the total window ADC and remove their contributions to the hit counts. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input_ta</td><td></td></tr>
    <tr><td class="paramname">window_length</td><td><br  />
 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="TAWindow_8cpp_source.html#l00045">45</a> of file <a class="el" href="TAWindow_8cpp_source.html">TAWindow.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   46</span>{</div>
<div class="line"><span class="lineno">   47</span>  uint32_t n_tas_to_erase = 0;</div>
<div class="line"><span class="lineno">   48</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> ta : <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a>) {</div>
<div class="line"><span class="lineno">   49</span>    <span class="keywordflow">if</span> (!(input_ta.time_start - ta.time_start &lt; window_length)) {</div>
<div class="line"><span class="lineno">   50</span>      n_tas_to_erase++;</div>
<div class="line"><span class="lineno">   51</span>      <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a070dc99f134cf339d975d41d1dae0b2a">adc_integral</a> -= ta.adc_integral;</div>
<div class="line"><span class="lineno">   52</span>      <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespacetriggeralgs.html#a7a9ef2563dfb84a0839fb5ab230b1728">TriggerPrimitive</a> tp : ta.<a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a>) {</div>
<div class="line"><span class="lineno">   53</span>        <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#aa483baf5d65b068cb68f8b1e037d5862">channel_states</a>[tp.channel]--;</div>
<div class="line"><span class="lineno">   54</span>        <span class="comment">// If a TA being removed from the window results in a channel no longer having</span></div>
<div class="line"><span class="lineno">   55</span>        <span class="comment">// any hits, remove from the states map so map.size() can be used for number</span></div>
<div class="line"><span class="lineno">   56</span>        <span class="comment">// channel hits.</span></div>
<div class="line"><span class="lineno">   57</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#aa483baf5d65b068cb68f8b1e037d5862">channel_states</a>[tp.channel] == 0)</div>
<div class="line"><span class="lineno">   58</span>          <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#aa483baf5d65b068cb68f8b1e037d5862">channel_states</a>.erase(tp.channel);</div>
<div class="line"><span class="lineno">   59</span>      }</div>
<div class="line"><span class="lineno">   60</span>    } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   61</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">   62</span>  }</div>
<div class="line"><span class="lineno">   63</span>  <span class="comment">// Erase the TAs from the window.</span></div>
<div class="line"><span class="lineno">   64</span>  <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a>.erase(<a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a>.begin(), <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a>.begin() + n_tas_to_erase);</div>
<div class="line"><span class="lineno">   65</span>  <span class="comment">// Make the window start time the start time of what is now the</span></div>
<div class="line"><span class="lineno">   66</span>  <span class="comment">// first TA.</span></div>
<div class="line"><span class="lineno">   67</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a>.size() != 0) {</div>
<div class="line"><span class="lineno">   68</span>    <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a25d53d4e6fc07eadcc932f8787e4fd4f">time_start</a> = <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a>.front().time_start;</div>
<div class="line"><span class="lineno">   69</span>    <a class="code hl_function" href="classtriggeralgs_1_1TAWindow.html#a59e8460960590df1de1c492665473a15">add</a>(input_ta);</div>
<div class="line"><span class="lineno">   70</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   71</span>    <a class="code hl_function" href="classtriggeralgs_1_1TAWindow.html#acd4fc83af5fefd45314f11b3455e4901">reset</a>(input_ta);</div>
<div class="line"><span class="lineno">   72</span>  }</div>
<div class="line"><span class="lineno">   73</span>  <span class="comment">// add(input_ta);</span></div>
<div class="line"><span class="lineno">   74</span>  <span class="comment">// time_start = inputs.front().time_start;</span></div>
<div class="line"><span class="lineno">   75</span>}</div>
<div class="ttc" id="aclasstriggeralgs_1_1TAWindow_html_a59e8460960590df1de1c492665473a15"><div class="ttname"><a href="classtriggeralgs_1_1TAWindow.html#a59e8460960590df1de1c492665473a15">triggeralgs::TAWindow::add</a></div><div class="ttdeci">void add(const TriggerActivity &amp;input_ta)</div><div class="ttdoc">Add the input TA's contribution to the total ADC, increase the hit count of all of the channels which...</div><div class="ttdef"><b>Definition</b> <a href="TAWindow_8cpp_source.html#l00016">TAWindow.cpp:16</a></div></div>
<div class="ttc" id="aclasstriggeralgs_1_1TAWindow_html_acd4fc83af5fefd45314f11b3455e4901"><div class="ttname"><a href="classtriggeralgs_1_1TAWindow.html#acd4fc83af5fefd45314f11b3455e4901">triggeralgs::TAWindow::reset</a></div><div class="ttdeci">void reset(TriggerActivity const &amp;input_ta)</div><div class="ttdoc">Reset window content on the input.</div><div class="ttdef"><b>Definition</b> <a href="TAWindow_8cpp_source.html#l00079">TAWindow.cpp:79</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad92d556ccf9b7f241da1ed070e808d83" name="ad92d556ccf9b7f241da1ed070e808d83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad92d556ccf9b7f241da1ed070e808d83">&#9670;&#160;</a></span>n_channels_hit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t triggeralgs::TAWindow::n_channels_hit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="TAWindow_8hpp_source.html#l00034">34</a> of file <a class="el" href="TAWindow_8hpp_source.html">TAWindow.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   34</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#aa483baf5d65b068cb68f8b1e037d5862">channel_states</a>.size(); };</div>
</div><!-- fragment -->
</div>
</div>
<a id="acd4fc83af5fefd45314f11b3455e4901" name="acd4fc83af5fefd45314f11b3455e4901"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd4fc83af5fefd45314f11b3455e4901">&#9670;&#160;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void triggeralgs::TAWindow::reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtriggeralgs_1_1TriggerActivity.html">TriggerActivity</a> const &amp;&#160;</td>
          <td class="paramname"><em>input_ta</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset window content on the input. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input_ta</td><td><br  />
 </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="TAWindow_8cpp_source.html#l00079">79</a> of file <a class="el" href="TAWindow_8cpp_source.html">TAWindow.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   80</span>{</div>
<div class="line"><span class="lineno">   81</span>  <span class="comment">// Empty the channel and TA lists.</span></div>
<div class="line"><span class="lineno">   82</span>  <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#aa483baf5d65b068cb68f8b1e037d5862">channel_states</a>.clear();</div>
<div class="line"><span class="lineno">   83</span>  <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a>.clear();</div>
<div class="line"><span class="lineno">   84</span>  <span class="comment">// Set the start time of the window to be the start time of the</span></div>
<div class="line"><span class="lineno">   85</span>  <span class="comment">// input_ta.</span></div>
<div class="line"><span class="lineno">   86</span>  <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a25d53d4e6fc07eadcc932f8787e4fd4f">time_start</a> = input_ta.time_start;</div>
<div class="line"><span class="lineno">   87</span>  <span class="comment">// Start the total ADC integral.</span></div>
<div class="line"><span class="lineno">   88</span>  <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a070dc99f134cf339d975d41d1dae0b2a">adc_integral</a> = input_ta.adc_integral;</div>
<div class="line"><span class="lineno">   89</span>  <span class="comment">// Start hit count for the hit channels.</span></div>
<div class="line"><span class="lineno">   90</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="namespacetriggeralgs.html#a7a9ef2563dfb84a0839fb5ab230b1728">TriggerPrimitive</a> tp : input_ta.<a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a>) {</div>
<div class="line"><span class="lineno">   91</span>    <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#aa483baf5d65b068cb68f8b1e037d5862">channel_states</a>[tp.channel]++;</div>
<div class="line"><span class="lineno">   92</span>  }</div>
<div class="line"><span class="lineno">   93</span>  <span class="comment">// Add the input TA to the TA list.</span></div>
<div class="line"><span class="lineno">   94</span>  <a class="code hl_variable" href="classtriggeralgs_1_1TAWindow.html#a6690ef66c223a08fc64b16e873c86dda">inputs</a>.push_back(input_ta);</div>
<div class="line"><span class="lineno">   95</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Friends And Related Symbol Documentation</h2>
<a id="adc5fed6d6b9a63c3be6c5faa6866f6c1" name="adc5fed6d6b9a63c3be6c5faa6866f6c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc5fed6d6b9a63c3be6c5faa6866f6c1">&#9670;&#160;</a></span>operator&lt;&lt;</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::ostream &amp; operator&lt;&lt; </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classtriggeralgs_1_1TAWindow.html">TAWindow</a> &amp;&#160;</td>
          <td class="paramname"><em>window</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">friend</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="TAWindow_8cpp_source.html#l00097">97</a> of file <a class="el" href="TAWindow_8cpp_source.html">TAWindow.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   99</span>{</div>
<div class="line"><span class="lineno">  100</span>  <span class="keywordflow">if</span> (window.is_empty())</div>
<div class="line"><span class="lineno">  101</span>    os &lt;&lt; <span class="stringliteral">&quot;Window is empty!\n&quot;</span>;</div>
<div class="line"><span class="lineno">  102</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  103</span>    os &lt;&lt; <span class="stringliteral">&quot;Window start: &quot;</span> &lt;&lt; window.time_start &lt;&lt; <span class="stringliteral">&quot;, end: &quot;</span> &lt;&lt; window.inputs.back().time_start;</div>
<div class="line"><span class="lineno">  104</span>    os &lt;&lt; <span class="stringliteral">&quot;. Total of: &quot;</span> &lt;&lt; window.adc_integral &lt;&lt; <span class="stringliteral">&quot; ADC counts with &quot;</span> &lt;&lt; window.inputs.size() &lt;&lt; <span class="stringliteral">&quot; TPs.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  105</span>    os &lt;&lt; window.channel_states.size() &lt;&lt; <span class="stringliteral">&quot; independent channels have hits.\n&quot;</span>;</div>
<div class="line"><span class="lineno">  106</span>  }</div>
<div class="line"><span class="lineno">  107</span>  <span class="keywordflow">return</span> os;</div>
<div class="line"><span class="lineno">  108</span>};</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a070dc99f134cf339d975d41d1dae0b2a" name="a070dc99f134cf339d975d41d1dae0b2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a070dc99f134cf339d975d41d1dae0b2a">&#9670;&#160;</a></span>adc_integral</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t triggeralgs::TAWindow::adc_integral</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="TAWindow_8hpp_source.html#l00053">53</a> of file <a class="el" href="TAWindow_8hpp_source.html">TAWindow.hpp</a>.</p>

</div>
</div>
<a id="aa483baf5d65b068cb68f8b1e037d5862" name="aa483baf5d65b068cb68f8b1e037d5862"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa483baf5d65b068cb68f8b1e037d5862">&#9670;&#160;</a></span>channel_states</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::unordered_map&lt;<a class="el" href="namespacetriggeralgs.html#a3b366738e21766946bfe8f1a4593d06b">channel_t</a>, uint16_t&gt; triggeralgs::TAWindow::channel_states</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="TAWindow_8hpp_source.html#l00054">54</a> of file <a class="el" href="TAWindow_8hpp_source.html">TAWindow.hpp</a>.</p>

</div>
</div>
<a id="a6690ef66c223a08fc64b16e873c86dda" name="a6690ef66c223a08fc64b16e873c86dda"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6690ef66c223a08fc64b16e873c86dda">&#9670;&#160;</a></span>inputs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structtriggeralgs_1_1TriggerActivity.html">TriggerActivity</a>&gt; triggeralgs::TAWindow::inputs</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="TAWindow_8hpp_source.html#l00055">55</a> of file <a class="el" href="TAWindow_8hpp_source.html">TAWindow.hpp</a>.</p>

</div>
</div>
<a id="a25d53d4e6fc07eadcc932f8787e4fd4f" name="a25d53d4e6fc07eadcc932f8787e4fd4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25d53d4e6fc07eadcc932f8787e4fd4f">&#9670;&#160;</a></span>time_start</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacetriggeralgs.html#a71eb817804d67a3159db1cebe6a2c2a3">timestamp_t</a> triggeralgs::TAWindow::time_start</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="TAWindow_8hpp_source.html#l00052">52</a> of file <a class="el" href="TAWindow_8hpp_source.html">TAWindow.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/github/workspace/dev_area/sourcecode/triggeralgs/include/triggeralgs/<a class="el" href="TAWindow_8hpp_source.html">TAWindow.hpp</a></li>
<li>/github/workspace/dev_area/sourcecode/triggeralgs/src/<a class="el" href="TAWindow_8cpp_source.html">TAWindow.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 24 2024 for DUNE-DAQ by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
