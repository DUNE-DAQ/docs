<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>DUNE-DAQ: Configuration creation, visualization and manipulation</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">DUNE-DAQ
   </div>
   <div id="projectbrief">DUNE Trigger and Data Acquisition software</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Configuration creation, visualization and manipulation</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md127"></a>This repository contains scripts for generating and manipulating OKS database files.</p>
<h1><a class="anchor" id="autotoc_md128"></a>
Visualization tools</h1>
<h2><a class="anchor" id="autotoc_md129"></a>
&lt;tt&gt;daqconf_inspector&lt;/tt&gt;</h2>
<p>Commandline utility to visually inspect and verify configurations databases and the objects they contain. Documenation available <a class="el" href="md__2github_2workspace_2dev__area_2sourcecode_2daqconf_2docs_2Inspector.html">here</a>.</p>
<h1><a class="anchor" id="autotoc_md130"></a>
Manipulation Tools</h1>
<h2><a class="anchor" id="autotoc_md131"></a>
&lt;tt&gt;oks_enable&lt;/tt&gt;</h2>
<p>Add Resource objects to or remove from the <code>disabled</code> relationship of a Session</p>
<h2><a class="anchor" id="autotoc_md132"></a>
&lt;tt&gt;consolidate&lt;/tt&gt;</h2>
<p>Merge the contents of several database files, putting all objects into a single output file. Output file will only include schemas.</p>
<h2><a class="anchor" id="autotoc_md133"></a>
&lt;tt&gt;consolidate_files&lt;/tt&gt;</h2>
<p>Merge the contents of several database files, preserving included databases. Output file will contain only objects defined in files given on command line.</p>
<h2><a class="anchor" id="autotoc_md134"></a>
&lt;tt&gt;copy_configuration&lt;/tt&gt;</h2>
<p>Copy the input file(s) to the specified directory, also moving any included files and updating include paths, to create a clone of the configuration databases.</p>
<h2><a class="anchor" id="autotoc_md135"></a>
&lt;tt&gt;get_apps&lt;/tt&gt;</h2>
<p>Retrieve the DAQ applications defined in the given configuration</p>
<h2><a class="anchor" id="autotoc_md136"></a>
&lt;tt&gt;oks-format&lt;/tt&gt;</h2>
<p>Ensure that database files are in the "DBE format", alphabetized and with correct spacing</p>
<h2><a class="anchor" id="autotoc_md137"></a>
&lt;tt&gt;oks_enable_tpg&lt;/tt&gt;</h2>
<p>Enable or disable TPG for a Session's ReadoutApplications</p>
<h2><a class="anchor" id="autotoc_md138"></a>
&lt;tt&gt;validate&lt;/tt&gt;</h2>
<p>Attempt to determine if a given Session configuration is valid and does not contain common errors</p>
<h2><a class="anchor" id="autotoc_md139"></a>
textual_dbe</h2>
<p>Attempt to replicate OKS' Data Base editor within Python. Full details are <a class="el" href="md__2github_2workspace_2dev__area_2sourcecode_2daqconf_2docs_2TextualDBE.html">here</a>. Current implementation is very incomplete so use with caution.</p>
<h1><a class="anchor" id="autotoc_md140"></a>
Generation Tools</h1>
<h2><a class="anchor" id="autotoc_md141"></a>
&lt;tt&gt;createOKSdb&lt;/tt&gt;</h2>
<p>A script that generates an 'empty' OKS database, just containging the include files for the core schema and any other schema/data files you specify on the commad line.</p>
<h2><a class="anchor" id="autotoc_md142"></a>
&lt;tt&gt;dromap2oks&lt;/tt&gt;</h2>
<p>Convert a JSON readout map file from dunedaq v4 to an OKS file.</p>
<h2><a class="anchor" id="autotoc_md143"></a>
&lt;tt&gt;generate_readoutOKS&lt;/tt&gt;</h2>
<p>Create an OKS configuration file defining ReadoutApplications for all readout groups defined in a readout map.</p>
<h1><a class="anchor" id="autotoc_md144"></a>
Additional Python Utilities</h1>
<h2><a class="anchor" id="autotoc_md145"></a>
&lt;tt&gt;assets.py&lt;/tt&gt;</h2>
<p>Read the DUNE-DAQ asset file database and return a path to a referenced asset file</p>
<h2><a class="anchor" id="autotoc_md146"></a>
&lt;tt&gt;generate.py&lt;/tt&gt;</h2>
<p>A collection of methods to generate segments and sessions.</p>
<h2><a class="anchor" id="autotoc_md147"></a>
&lt;tt&gt;generate_hwmap.py&lt;/tt&gt;</h2>
<p>Create a set of DetectorToDaqConnection objects, GeoIDs, and streams for the given number of links and applications.</p>
<h2><a class="anchor" id="autotoc_md148"></a>
&lt;tt&gt;utils.py&lt;/tt&gt;</h2>
<p>Utilities for parsing OKS databases. Currently contains an include file search routine.</p>
<h1><a class="anchor" id="autotoc_md149"></a>
Creating A Diagram of Your Configuration</h1>
<p>In <code>daqconf</code> it's possible to create a diagram of a DAQ configuration in the <a href="https://en.wikipedia.org/wiki/DOT_(graph_description_language)">DOT graph description language</a>, which can then be fed to the <code>dot</code> program to generate a viewable graphic. This is accomplished using the <code>create_config_plot</code> application. You can run <code>create_config_plot -h</code> to see how it's used, but to explain it simply, you provide it with a database file, the name of a session in that database, and then the name of an object associated with the session. It will create a plot using that object as the root of the plot. Note the object either needs to be the session itself, or a segment or an application in it. E.g., with the <code>daqsystemtest</code> repo you can generate a plot of the <code>mlt</code> application in its <code>ehn1-local-2x3-config</code> test DAQ session via: </p><div class="fragment"><div class="line">create_config_plot -f config/daqsystemtest/example-configs.data.xml -s ehn1-local-2x3-config -r mlt</div>
</div><!-- fragment --><p> and if you want to plot the entire session, you can run </p><div class="fragment"><div class="line">create_config_plot -f config/daqsystemtest/example-configs.data.xml -s ehn1-local-2x3-config -r ehn1-local-2x3-config</div>
</div><!-- fragment --><p> or a shorthand version of that command is </p><div class="fragment"><div class="line">create_config_plot -f config/daqsystemtest/example-configs.data.xml -s ehn1-local-2x3-config</div>
</div><!-- fragment --><p> ...where if no root object is specified the default is for <code>create_config_plot</code> to take the session passed to <code>-s</code> and use it as the root object. Also note that in the event that there's a single session in the database, the <code>-s &lt;session-name&gt;</code> argument isn't required. Any of the above commands will create (or clobber) a file called <code>config.dot</code>. If you wish to give the file a different name you can use the <code>-o</code> option, e.g., <code>-o mypreferredname.dot</code>. Once you have the DOT file, you can generate a graphic by doing the following: </p><div class="fragment"><div class="line">dot -Tsvg -o mypreferredname.svg config.dot</div>
</div><!-- fragment --><p> ...which can then be displayed, e.g., in a browser window via the link <code><a href="file:///path/to/file/mypreferredname.svg">file:///path/to/file/mypreferredname.svg</a></code>.</p>
<p>Note that while <code>dot</code> is available on the np04 cluster's system, it's not necessarily available on other hosts. If you're on another host, you may need to execute <code>spack load graphviz</code> in your work area to get the <code>dot</code> executable. Note that in this scenario that after you're done using <code>dot</code> if you wish to develop code you'll want to <code>spack unload graphviz</code>; more generally, your build environment isn't guaranteed to continue working after you run <code>spack load &lt;package&gt;</code>. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 24 2024 for DUNE-DAQ by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
